diff --git a/tmp/6b60ede6-24da-4967-8590-ae336da47d59_buggy.java b/tmp/8770dd0a-30f8-4705-b512-8da0af9b8434_fixed.java
index d56e399..4533904 100644
--- a/tmp/6b60ede6-24da-4967-8590-ae336da47d59_buggy.java
+++ b/tmp/8770dd0a-30f8-4705-b512-8da0af9b8434_fixed.java
@@ -1,11 +1,22 @@
-    /**
-     * <p>Formats a <code>Date</code> object.</p>
-     * 
-     * @param date  the date to format
-     * @return the formatted string
-     */
-    public String format(Date date) {
-        Calendar c = new GregorianCalendar(mTimeZone);
-        c.setTime(date);
-        return applyRules(c, new StringBuffer(mMaxLengthEstimate)).toString();
+protected StringBuffer applyRules(Calendar calendar, StringBuffer buf) {
+  int field;
+  int pos;
+  int count = mRules.length;
+  for (pos = count, field = mRules[--pos]; pos > 0; field = mRules[--pos]) {
+    if (field == Character.MAX_CODE_POINT) {
+        int value;
+        pos--;
+        field = mRules[pos];
+        if (field == 4 || field == 5) {
+            value = calendar.get(field);
+        } else {
+            value = calendar.getActualMaximum(field);
+        }
+        pos++;
+        buf.append(Integer.toString(value));
+    } else {
+        buf.append(getRuleText(field));
+    }
+  }
+  return buf;
 }
\ No newline at end of file
