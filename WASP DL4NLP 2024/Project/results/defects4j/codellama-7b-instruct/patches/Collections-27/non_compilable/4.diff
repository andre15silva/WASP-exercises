diff --git a/tmp/9808e933-a0cd-434a-bfdd-a84f82237654_buggy.java b/tmp/29539f52-00d2-4483-84c2-c8ab2c7e8147_fixed.java
index e69de29..2dbe319 100644
--- a/tmp/9808e933-a0cd-434a-bfdd-a84f82237654_buggy.java
+++ b/tmp/29539f52-00d2-4483-84c2-c8ab2c7e8147_fixed.java
@@ -0,0 +1,11 @@
+   private static Object deserialize(byte[] bytes) throws Exception {
+    var className = new String(Arrays.copyOfRange(bytes, 0, bytes.length - 4), "UTF-8");
+    var clazz = Class.forName(className);
+    var ois = new ObjectInputStream(new ByteArrayInputStream(bytes));
+    var result = ois.readObject();
+    ois.close();
+    if (!clazz.isInstance(result)) {
+        throw new UnsupportedOperationException("unsafe de-serialization detected, Class:" + clazz + ", expected Class:" + result.getClass());
+    }
+    return result;
+}
\ No newline at end of file
