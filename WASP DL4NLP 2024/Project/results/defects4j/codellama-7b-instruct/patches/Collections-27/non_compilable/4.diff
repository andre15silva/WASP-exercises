diff --git a/tmp/42fb7c76-e5ab-4e85-a5c5-072c9c1e330d_buggy.java b/tmp/1a28ed38-f75b-4f25-9efe-71dc8b298126_fixed.java
index e69de29..2dbe319 100644
--- a/tmp/42fb7c76-e5ab-4e85-a5c5-072c9c1e330d_buggy.java
+++ b/tmp/1a28ed38-f75b-4f25-9efe-71dc8b298126_fixed.java
@@ -0,0 +1,11 @@
+   private static Object deserialize(byte[] bytes) throws Exception {
+    var className = new String(Arrays.copyOfRange(bytes, 0, bytes.length - 4), "UTF-8");
+    var clazz = Class.forName(className);
+    var ois = new ObjectInputStream(new ByteArrayInputStream(bytes));
+    var result = ois.readObject();
+    ois.close();
+    if (!clazz.isInstance(result)) {
+        throw new UnsupportedOperationException("unsafe de-serialization detected, Class:" + clazz + ", expected Class:" + result.getClass());
+    }
+    return result;
+}
\ No newline at end of file
