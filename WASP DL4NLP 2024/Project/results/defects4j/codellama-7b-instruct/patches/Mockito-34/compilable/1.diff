diff --git a/tmp/987e56d5-9a80-45d2-9e96-2eb3b304491e_buggy.java b/tmp/54885f2c-5143-4834-8b8a-7f95f25d7ae8_fixed.java
index d68a69c..e71f5c9 100644
--- a/tmp/987e56d5-9a80-45d2-9e96-2eb3b304491e_buggy.java
+++ b/tmp/54885f2c-5143-4834-8b8a-7f95f25d7ae8_fixed.java
@@ -1,9 +1,16 @@
     public void captureArgumentsFrom(Invocation i) {
+        if (i.getArguments() == null || i.getArguments().length == 0) {
+            throw new IllegalArgumentException("Cannot capture arguments from null or empty argument list");
+        }
         int k = 0;
         for (Matcher m : matchers) {
             if (m instanceof CapturesArguments) {
+                if (k < i.getArguments().length) {
                     ((CapturesArguments) m).captureFrom(i.getArguments()[k]);
+                } else {
+                    break;
+                }
             }
             k++;
         }
     }
