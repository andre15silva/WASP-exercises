diff --git a/tmp/978c7eaf-dd4b-442f-9284-f79ea7f35dae_buggy.java b/tmp/81359e4f-b576-439e-adf3-ccb47f696dcc_fixed.java
index a37dc7a..14d50bf 100644
--- a/tmp/978c7eaf-dd4b-442f-9284-f79ea7f35dae_buggy.java
+++ b/tmp/81359e4f-b576-439e-adf3-ccb47f696dcc_fixed.java
@@ -1,10 +1,19 @@
     protected void addChildren(int index, Node... children) {
         Validate.noNullElements(children);
         ensureChildNodes();
+        Node node = this;
         for (int i = children.length - 1; i >= 0; i--) {
             Node in = children[i];
+            Node parent = in.parentNode;
+            if (parent == null || parent == node) {
                 reparentChild(in);
                 childNodes.add(index, in);
+            } else {
+                int prevIndex = parent.childNodes.indexOf(in);
+                parent.childNodes.remove(prevIndex);
+                reparentChild(in);
+                childNodes.add(index, in);
+            }
         }
         reindexChildren(index);
     }
\ No newline at end of file
