diff --git a/tmp/d43a8da2-1690-442a-88a5-9de3b87810d8_buggy.java b/tmp/cde09cdf-47db-4467-a782-4017b680d229_fixed.java
index a37dc7a..c1e07a2 100644
--- a/tmp/d43a8da2-1690-442a-88a5-9de3b87810d8_buggy.java
+++ b/tmp/cde09cdf-47db-4467-a782-4017b680d229_fixed.java
@@ -1,10 +1,14 @@
     protected void addChildren(int index, Node... children) {
         Validate.noNullElements(children);
         ensureChildNodes();
         for (int i = children.length - 1; i >= 0; i--) {
             Node in = children[i];
             reparentChild(in);
             childNodes.add(index, in);
+            if (in instanceof Element && ((Element)in).parent() != this) {
+                // if this is a fragment, or any of its children have moved into another element, we need to re-index children
+                break;
+            }
         }
         reindexChildren(index);
     }
