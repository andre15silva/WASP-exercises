diff --git a/tmp/b736fbf1-5cc2-4a00-8baf-b1b84bd3b067_buggy.java b/tmp/3f5167cc-51f6-40a2-a71f-11b5fb6ffe54_fixed.java
index a667cbe..9ca3619 100644
--- a/tmp/b736fbf1-5cc2-4a00-8baf-b1b84bd3b067_buggy.java
+++ b/tmp/3f5167cc-51f6-40a2-a71f-11b5fb6ffe54_fixed.java
@@ -1,10 +1,16 @@
     /**
      * Recalculate the hash code after deserialization. The hash code of some
      * keys might have change (hash codes based on the system hash code are
      * only stable for the same process).
      * @return the instance with recalculated hash code
      */
     private Object readResolve() {
-        calculateHashCode(keys);
+        int newHashCode = calculateHashCode(keys);
+        if (newHashCode == hashCode) {
             return this;
         }
+        // If the keys are equal (not the actual instances, but their contents),
+        // we use this method otherwise equals() and hashCode() will be broken
+        final Object[] newKeys = (Object[]) keys.clone();
+        return new MultiKey(newKeys);
+    }
