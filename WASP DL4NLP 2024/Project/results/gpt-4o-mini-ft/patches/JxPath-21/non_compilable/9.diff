diff --git a/tmp/fbede4f1-f278-499e-a99b-ec93cec91205_buggy.java b/tmp/e1d750b4-e599-4cd3-9de8-217a72278614_fixed.java
index 516fad7..db8aec0 100644
--- a/tmp/fbede4f1-f278-499e-a99b-ec93cec91205_buggy.java
+++ b/tmp/e1d750b4-e599-4cd3-9de8-217a72278614_fixed.java
@@ -1,8 +1,34 @@
     /**
      * If the property contains a collection, then the length of that
      * collection, otherwise - 1.
      * @return int length
      */
     public int getLength() {
         return ValueUtils.getLength(getBaseValue());
     }
+
+    @Override
+    public Boolean isEqual(Object value) {
+        boolean equals = super.isEqual(value);
+        if (isFocusable()) {
+            try {
+                boolean isEnclosed = false;
+                if (getBaseValue() instanceof AbstractCollection) {
+                    isEnclosed = !(Long.valueOf(((AbstractCollection) getBaseValue()).size()).equals
+                        (getInstance().evaluate("count(" + getHistoryPointer() + "/node())")))
+                        && "{" + getInstance().getName() + "}"
+                        + getInstance().getInstanceId()
+                        + "/" + getHistoryPointer();
+                } else {
+                    List<NodeInfo> nodes = getInstance().getNodeSet(getHistoryPointer()).nodes();
+                    isEnclosed = !(nodes.size() == 1 && nodes.get(0).isSameNodeInfo(getBaseValue()));
+                }
+                if (!equals && isEnclosed) {
+                    return Boolean.FALSE;
+                }
+            } catch (EvaluationException e) {
+                log.error(getHistoryPointer() + "/node() failed", e);
+            }
+        }
+        return equals;
+    }
